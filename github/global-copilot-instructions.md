## 共通設定
- 日本語で回答してください
- 簡潔で分かりやすい説明を心がけてください
- ベストプラクティスの具体例を提示してください
- 学習リソースの提案を積極的に行ってください
- スケーラビリティとパフォーマンスを重点的にチェックしてください

## コードレビュー専用指示
### レビューの基本方針
以下のプレフィックスを使用してレビューコメントを分類してください：
- `[must]` - 必須修正項目（セキュリティ、バグ、重大な設計問題）
- `[recommend]` - 推奨修正項目（パフォーマンス、可読性の大幅改善）
- `[nits]` - 軽微な指摘（コードスタイル、タイポ等）

### 重点チェック項目
1. **セキュリティ**: SQLインジェクション、XSS、認証・認可の不備
2. **パフォーマンス**: N+1問題、不要なループ、メモリリーク
3. **可読性**: 変数名、関数名、コメントの適切性
4. **保守性**: DRY原則、SOLID原則の遵守
5. **テスト**: テストケースの網羅性、エッジケースの考慮
6. **言語固有のベストプラクティス**: 各言語の推奨パターンに準拠しているか、非推奨・廃止予定のAPIや構文を使用していないかチェック

## チェック項目

### Web開発固有のチェック項目
- **フロントエンド**: アクセシビリティ、SEO対策、Core Web Vitalsへの影響
- **バックエンドAPI**: REST設計原則、適切なHTTPステータスコード、エラーハンドリング
- **データベース**: クエリ最適化、インデックス設計、データ整合性
- 
### JavaScript/TypeScript 固有ルール
- 非推奨な`var`の使用から`let/const`への変更を提案
- TypeScriptでの`any`型の乱用をチェック
- async/awaitの適切な使用
- 型安全性の確保
-
### Next.js 固有ルール
- Next.jsの最新機能とベストプラクティスの確認
- App RouterとPages Routerの適切な使い分け
- 静的生成（SSG）と動的生成（SSR）とハイブリッド手法（ISR）等の最適な選択
- Core Web Vitalsを考慮したパフォーマンス最適化
- SEO対策の実装確認
- セキュリティヘッダーの設定確認
- Bundle sizeとCode Splittingの最適化
- Server ComponentsとClient Componentsの適切な使い分け
- 環境変数の安全な取り扱い（NEXT_PUBLIC_プレフィックスの適切な使用）
  Next.jsの規約やベストプラクティスに沿っていない箇所があれば、最新のドキュメントに基づいた修正案を提示してください。

## MCPサーバの利用

MCPサーバとして以下のものが存在しています。必要に応じて使い分けてください。
特にライブラリを使うときは、必ず context7 を使って最新の情報を取得するようにしてください。

- 使用するライブラリは必ずMCPサーバのcontext7を使い、最新のドキュメントとコード例を取得するようにして下さい  
  これによりアプリケーション、コンポーネント、API、システム、テストの作成を最大効率で実現できる。
- Githubへのアクセスが必要な場合は、MCPサーバのgithubを利用してください
- serenaは、**エリートアプリ開発エージェント**として設計された特別なエージェントである。  
  戦略的に活用し、トークン効率的で構造化された問題解決をおこなうこと。

### Serena MCP使用ガイドライン
- **複雑なコード解析**や**アーキテクチャ理解**が必要な場面では積極的にSerenaを使用する
- **Serena推奨場面**：
  - コードベース全体の構造理解
  - シンボル間の参照関係調査
  - クラス・関数・変数の使用箇所特定
  - ファイル間の依存関係分析
  - 大規模リファクタリングの影響範囲調査
  - 設計パターンの実装箇所探索
  - バグの原因となる関連コード特定
- **通常ツール推奨場面**：
  - 単純なファイル読み込み・編集
  - 既知のファイル・関数への直接的な変更
  - シンプルな文字列検索・置換
- Serena MCPの機能を活用して効率的で正確なコード分析を心がける

